---
title: "Assignment_3_Problem_2"
author: "Sai Anjesh"
date: "2024-03-12"
output: html_document
---

```{r}
## Essential modules to import
library(dplyr)
```

### For this problem we are going to use UCI’s student performance dataset. The dataset is a recording of student grades in math and language and includes attributes related to student demographics and school related features. Click on the above link, then go to “Data Folder” and download and unzip “student.zip”. You will be using student-mat.csv file. The goal is to create a regression model to forecast student final grade in math “G3” based on the other attributes.

-----

##### 11. (0.5pt) Read the dataset into a dataframe. Ensure that you are using a correct delimiter to read the data correctly and set the “sep” option in read.csv accordingly.

```{r}
# Input data paths
student_mat_data_path <- "D:/UIS/Studies/Semester4/CSC532/Assignments/Assignment3/regression_project/input_datasets/student+performance/student/student-mat.csv"
```


```{r}
# Reading data
student_mat_data <- read.csv(file = student_mat_data_path, 
                             header = TRUE,
                             sep = ";")
```

##### 12. (2pt) Explore the dataset. More specifically, answer the following questions:

###### a. Is there any missing values in the dataset?

```{r}
# Let us check if there are any null / missing values
cat(paste(
  "Prelimiary Check for the existence of null values : ", 
  sum(is.na(student_mat_data)), 
  sep = ""))

# let us check the null values values in different formats
student_mat_data_NA_Check <- student_mat_data
student_mat_data_NA_Check[student_mat_data_NA_Check %in% c("NA", "N/A", "NULL", "", "."," ","?")] <- NA
print(sum(is.na(student_mat_data_NA_Check)))
```
So basically there are no missign values, hence we are gonna proceed further with the assignment questions.

When checked this link: https://archive.ics.uci.edu/dataset/320/student+performance
I was able to make sure that my investigation is right because the website says no maiisgin values.

###### b. Which variables are associated with the target variable G3? To answer this question, use appropriate plots and test statistics based on variable types. You can do this one by one for all variables or write a loop that applies appropriate statistic tests based on variable types. Either approach is fine.

To understand that we would first have to undertand the strucutre of the dataframe and get summary of the dataframe.

```{r}
# Structure fo the dataframe
str(student_mat_data)

# Summary
summary(student_mat_data)
```

There are 33 features. Let us check the columns and data types.

```{r}
# Code resued from my Assignemnetn 2 solution
numeric_cols <- colnames(student_mat_data)[sapply(student_mat_data, is.numeric)]
factor_cols <- colnames(student_mat_data)[sapply(student_mat_data, is.factor)]
character_cols <- colnames(student_mat_data)[sapply(student_mat_data, is.character)]

# Checking the column names
cat("Numeric columns: \n------\n", paste(numeric_cols, collapse = ", "), "\n")
cat("Factor columns: \n------\n", paste(factor_cols, collapse = ", "), "\n")
cat("Character columns: \n------\n", paste(character_cols, collapse = ", "), "\n")
```

Since we don't have factor variables hence let us make all the character variables to factor variables.

```{r}
# Let us select each character variable and make it a factor variable



```


```{r}
## Reused My Code from the Assignment 1 - automation
## and made it into a function

# Nuerical vs Categ(2 types) - Two test 
diagnose_association_numerical <- function(df, 
                                           numer_vars, 
                                           target_var, 
                                           signif_val = 0.05) {
  numer_p_value_dataframe <- data.frame()
  for(v in numer_vars){
    
    print(paste("*************",v,"*************",sep= ""))
    plot(df[,v]~df[, target_var], 
       col="green", 
       main = paste("Box Plot - ",target_var," vs. ",v, sep = ""),
       xlab = target_var,
       ylab = v)
    
    # t.test - to test whether a categorical variable with two levels is
    # independent of a continuous numerical variable
    numer_Test_details = t.test(df[,v] ~ df[,target_var], 
                                alternative = "two.sided")
    print(numer_Test_details)
    numer_p_value_dataframe <- rbind(
      numer_p_value_dataframe,
      data.frame(feature1 = target_var,
                 feature2 = v,
                 p.value = numer_Test_details["p.value"]))
    }
  
  numer_p_value_dataframe$signif <- signif_val
  numer_p_value_dataframe$result <- (
    ifelse(
      numer_p_value_dataframe$p.value < numer_p_value_dataframe$signif,
      "pass", "fail" ))
  
  return(numer_p_value_dataframe)
  
}

# Categorical vs Categoricl - ChiSQ Test
diagnose_association_factor <- function(df,
                                        factor_vars, 
                                        target_var,
                                        signif_val = 0.05) {
  
  factor_p_value_dataframe <- data.frame()
  for(v in factor_vars[(!factor_vars %in% c(target_var))]){
    print(paste("--------------------",v,"--------------------"))
    ctable <- table(df[, v], df[, target_var])
    mosaicplot(ctable,
               ylab = target_var,
               xlab = v,
               main = paste("Mosaic graph of",target_var,"vs",v,sep = " "))
    print(chisq.test(ctable))
    factor_Test_details = chisq.test(ctable)
    factor_p_value_dataframe <- rbind(
      factor_p_value_dataframe,
      data.frame(feature1 = target_var,
                 feature2 = v,
                 p.value = factor_Test_details["p.value"]))
    }
  
  factor_p_value_dataframe$signif <- signif_val
  factor_p_value_dataframe$result <- (
    ifelse(
      factor_p_value_dataframe$p.value < factor_p_value_dataframe$signif,
      "pass", "fail" ))
  
  return(factor_p_value_dataframe)
}



assoc_num_df <- diagnose_association_numerical(df = bank_data, 
                                         numer_vars = numeric_cols,
                                         target_var = "y")
assoc_fac_df <- diagnose_association_factor(df = bank_data, 
                                            factor_vars = factor_cols,
                                            target_var = "y")


qualified_features_data <- assoc_num_df %>% rbind.data.frame(assoc_fac_df)

qualified_features_data
```


###### c. Draw a histogram of the target variable “G3” and interpret it.